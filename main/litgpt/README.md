this is going to be a slightly complicated example of DDP